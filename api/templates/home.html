{% extends 'base.html' %}

{% block title %}Home{% endblock %}

{% block content %}
{% if user.is_authenticated %}
  Hi {{ user.username }}!
    <p>
    <button id="create-game">Create game</button>
    </p>
{#    {% for game in games %}#}
{#        <p>{{ game.uuid }}</p>#}
{#        <p><a href="{% url 'logout' %}">logout</a></p>#}
{#    {% endfor %}#}
  <p><a href="{% url 'logout' %}">logout</a></p>
{% else %}
  <p>You are not logged in</p>
  <a href="{% url 'login' %}">login</a>
{% endif %}


    <script>
        var chatSocket = new WebSocket(
            'ws://' + window.location.host + '/ws/chess_game/');

        chatSocket.onmessage = function (e) {
            var data = JSON.parse(e.data);
            console.log(data);
            {#var message = data['message'], username = data['username'];#}
            {#document.querySelector('#chat-log').value += (username + ': ' + message + '\n');#}
        };

        chatSocket.onclose = function (e) {
            console.error('Chat socket closed unexpectedly');
        };

        document.querySelector('#create-game').onclick = function (e) {
            chatSocket.send(JSON.stringify({
                'command': 'create'
            }));

        };
    </script>
{% endblock %}
